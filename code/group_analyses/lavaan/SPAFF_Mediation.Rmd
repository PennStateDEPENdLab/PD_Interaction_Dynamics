---
title: "SPAFF Pre-post analyses"
author: "Alison Schreiber"
date: "9/5/2017"
output:
  html_document:
    df_print: kable
    mathjax: default
    number_sections: yes
    theme: yeti
    toc: yes
  pdf_document:
    toc: yes
---

<style type="text/css">
body{ font-size: 24px; max-width: 2000px; margin: auto; padding: 1em; }
code.r{ font-size: 15px; }
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Load required packages
```{r}
library(plyr)
library(tidyverse)
library(lavaan)
library(GGally)
```


#Load in data
##Load in SPAFF Data
```{r}
readSPAFFFile <- function(fname) {
  stopifnot(file.exists(fname))
  
  #Handle three possible file formats, one uses semicolons and has slightly different field names (newer), the other uses commas (older).
  #The newest has a separate set of fields
  head <- scan(fname, what="character", n=10, sep = "\n") #, fileEncoding="UTF-16LE") #NEWEST FILES HAVE UTF 16 encoding, which throws things off
  hlineRow <- grep("Header Lines:", head, fixed=TRUE) #this line always comes just before field names
  if (length(hlineRow) == 0L) {
    #newest format does not have the Header Lines: row in the text file, just begins with field names on first row
    hlineRow <- 1
    fieldRow <- head[1L]
    skip <- 1
  } else {	
    fieldRow <- scan(fname, what="character", n=1, skip=hlineRow, sep="\n")
    skip <- hlineRow + 1
  }
  
  #expect a bunch of semicolons or commas in this row
  ncommas <- sapply(regmatches(fieldRow, gregexpr(",", fieldRow)), length)
  nsemicolons <- sapply(regmatches(fieldRow, gregexpr(";", fieldRow)), length)
  
  if (ncommas >= 5 && ncommas > nsemicolons) {
    sep <- ","
  } else if (nsemicolons >= 5 && nsemicolons > ncommas) {
    sep <- ";"
  } else { warning("Unable to determine field separator.") }
  
  # old field names format (e.g., 8003_P1.txt)
  # [1] "Relative Time (seconds)" "Observation Name"        "Event Log File Name"     "Subject"                
  # [5] "Behavior"                "Event Type"              "Comment" 
  
  # new field names format (e.g., 8015_P1.txt)
  # [1] "Time"                "ObservationName"     "Event Log File Name"      "Subject"
  # [5] "Behavior"            "State Event"         "Comment" 
  
  fieldNames <- gsub("\"", "", strsplit(fieldRow, sep)[[1]])
  behav <- read.table(fname, skip=skip, header=FALSE, sep=sep)
  #for almost all files, there is a trailing comma/semicolon in file format, so drop last column
  if (ncol(behav) - length(fieldNames) == 1) { behav[[ncol(behav)]] <- NULL }
  names(behav) <- make.names(fieldNames)
  
  if (identical(names(behav), c("Time", "ObservationName", "Event.Log.File.Name", "Subject", "Behavior", "State.Event", "Comment"))) {
    #rename to old-style names for consistency
    names(behav) <- c("Relative.Time..seconds.", "Observation.Name", "Event.Log.File.Name", "Subject", "Behavior", "Event.Type", "Comment")
  } else if (identical(names(behav),  c("Relative.Time..seconds.", "Observation.Name", "Event.Log.File.Name", "Subject", "Behavior", "Event.Type", "Comment"))) {
   
    names(behav) <- c("Relative.Time..seconds.", "Observation.Name", "Event.Log.File.Name", "Subject", "Behavior", "Event.Type", "Comment")
  
  } else if (identical(names(behav), c("Date_Time_Absolute_dmy_hmsf", "Date_dmy", "Time_Absolute_hms", "Time_Absolute_f", "Time_Relative_hmsf", "Time_Relative_hms",
                                       "Time_Relative_f", "Time_Relative_sf", "Duration_sf", "Observation", "Event_Log", "Behavior", "Event_Type"))) {
    #newest format: drop irrelevant columns
    behav <- behav[,c("Time_Relative_sf", "Observation", "Behavior", "Event_Type")]
    names(behav) <- c("Relative.Time..seconds.", "Observation.Name", "Behavior", "Event.Type")
  } else {
    print(names(behav))
    stop("Unable to identify column names in SPAFF file: ", fname)
  }
  
  return(behav[,c("Relative.Time..seconds.", "Observation.Name", "Behavior", "Event.Type")])
} 

idfolders <- list.files(path="/Users/alisonmarie526/Box Sync/DEPENd/Projects/GSR/data/renamed_files", full.names=TRUE, recursive = FALSE)
idlist <- as.numeric(sub("/Users/alisonmarie526/Box Sync/DEPENd/Projects/GSR/data/renamed_files/(8[0-9]{3}).*", "\\1", idfolders, perl = TRUE))

tb <- as.data.frame(table(idlist))
allSPAFFfiles <- c()
for (i in 1:length(idfolders)) {
  filename = idfolders[i]
  f <- readSPAFFFile(filename)
  f <- dplyr::rename(f, time = Relative.Time..seconds.)
  f <- dplyr::filter(f, Event.Type == "State stop")
  f <- dplyr::mutate(f, diff_event = c(f$time[[1]], diff(time)))
  f$PTNUM <- factor(idlist[i])
  f$K <- sub("/Users/alisonmarie526/Box Sync/DEPENd/Projects/GSR/data/renamed_files/8[0-9]{3}.*(P[1-2]{1}).*", "\\1",idfolders[i],perl= TRUE)
  allSPAFFfiles <-rbind(allSPAFFfiles, f)
}
physLog <- read.csv(file = "/Users/alisonmarie526/Box Sync/DEPENd/Projects/GSR/data/physLog.csv")
physLog <- dplyr::select(physLog, PTNUM, DyadID, UsrID, K)
physLog$PTNUM <- as.character(physLog$PTNUM)
physLog$K <- as.character(physLog$K)
allSPAFFfiles$K <- as.character(allSPAFFfiles$K)
allSPAFFfiles$PTNUM <- as.character(allSPAFFfiles$PTNUM)
spaff_patpar <- dplyr::inner_join(allSPAFFfiles, physLog, by = c("PTNUM", "K")) 
spaff_patpar$Behavior <- as.character(spaff_patpar$Behavior)
spaff_patpar$valence <- sapply(spaff_patpar$Behavior, function(x) {
  x <- tolower(as.character(x))
  
  if (x=="disgust") { -3
  } else if (x=="contempt") { -4
  } else if (x=="belligerence") { -2
  } else if (x=="low domineering") { -1
  } else if (x=="high domineering") { -1
  } else if (x=="criticism") { -2              
  } else if (x=="anger") { -1
  } else if (x=="tension") { 0              
  } else if (x=="tense humor" || x=="tension/humor") { 2              
  } else if (x=="defensive") { -2
  } else if (x=="whining") { -1
  } else if (x=="sadness") { -1
  } else if (x=="stonewalling" || x=="stonewall") { -2
  } else if (x=="neutral") { 0.1
  } else if (x=="interest") { 2
  } else if (x=="low validation") { 4
  } else if (x=="high validation") { 4
  } else if (x=="affection") { 4
  } else if (x=="humor") { 4
  } else if (x=="surprise/joy") { 4              
  } else if (x=="physical affection") { 4              
  } else { stop("cannot match code: ", x)}            
})

spaff_patpar$n3 <- factor(sapply(spaff_patpar$Behavior, function(x) {
  x <- tolower(as.character(x))
  
  if (x=="disgust") { "nasty"
  } else if (x=="contempt") { "nasty"
  } else if (x=="belligerence") { "nasty"
  } else if (x=="low domineering") { "nasty"
  } else if (x=="high domineering") { "nasty"
  } else if (x=="criticism") { "nasty"   
  } else if (x=="anger") { "nasty"
  } else if (x=="tension") { "nasty"              
  } else if (x=="tense humor" || x=="tension/humor") { "nice"              
  } else if (x=="defensive") { "nasty"
  } else if (x=="whining") { "nasty"
  } else if (x=="sadness") { "nasty"
  } else if (x=="stonewalling" || x=="stonewall") { "nasty"
  } else if (x=="neutral") { "neutral"
  } else if (x=="interest") { "nice"
  } else if (x=="low validation") { "nice"
  } else if (x=="high validation") { "nice"
  } else if (x=="affection") { "nice"
  } else if (x=="humor") { "nice"
  } else if (x=="surprise/joy") { "nice"              
  } else if (x=="physical affection") { "nice"              
  } else { stop("cannot match code: ", x)}            
}))

```

##Load in Personality Data

```{r}
df <- read.csv(file = "~/Box Sync/DEPENd/Projects/PD_Interaction_Dynamics/data/params_personalitydata_all.csv")

df_personalitydata <- dplyr::select(df, PTNUM, iip_elevation_patient, iip_elevation_partner, pdtot_patient, pdtot_partner, self_coupling_patient, self_coupling_partner, cross_coupling_patient, cross_coupling_partner)
df_personalitydata_patient <- dplyr::select(df_personalitydata, iip_elevation_patient, pdtot_patient, self_coupling_patient, cross_coupling_patient, PTNUM)
df_personalitydata_partner <- dplyr::select(df_personalitydata, iip_elevation_partner, pdtot_partner, self_coupling_partner, cross_coupling_partner, PTNUM)
df_personalitydata_patient$DyadID <- paste0(df_personalitydata_patient$PTNUM, "_1")
df_personalitydata_patient$Patient <- 1
df_personalitydata_partner$DyadID <- paste0(df_personalitydata_partner$PTNUM, "_0")
df_personalitydata_partner$Patient <- 0
df_personalitydata_patient <-dplyr::rename(df_personalitydata_patient, iip_elevation = iip_elevation_patient, pdtot = pdtot_patient, self_coupling = self_coupling_patient, cross_coupling = cross_coupling_patient)
df_personalitydata_partner <-dplyr::rename(df_personalitydata_partner, iip_elevation = iip_elevation_partner, pdtot = pdtot_partner, self_coupling = self_coupling_partner, cross_coupling = cross_coupling_partner)
df_personaitydata_long <- dplyr::bind_rows(df_personalitydata_patient, df_personalitydata_partner)


#df_personalitydata <- dplyr::select(m13dat4, PTNUM, iip_elevation_patient, iip_elevation_partner, pdcpt, pdcpr, scpr, scpt, ccpt, ccpr)
df_personalitydata_patient <- dplyr::select(df_personalitydata, iip_elevation_patient, pdtot_patient, self_coupling_patient, cross_coupling_patient, PTNUM)
df_personalitydata_partner <- dplyr::select(df_personalitydata, iip_elevation_partner, pdtot_partner, self_coupling_partner, cross_coupling_partner, PTNUM)
df_personalitydata_patient$DyadID <- paste0(df_personalitydata_patient$PTNUM, "_1")
df_personalitydata_patient$Patient <- 1
df_personalitydata_partner$DyadID <- paste0(df_personalitydata_partner$PTNUM, "_0")
df_personalitydata_partner$Patient <- 0
df_personalitydata_patient <-dplyr::rename(df_personalitydata_patient, iip_elevation = iip_elevation_patient, pdtot = pdtot_patient, self_coupling = self_coupling_patient, cross_coupling = cross_coupling_patient)
df_personalitydata_partner <-dplyr::rename(df_personalitydata_partner, iip_elevation = iip_elevation_partner, pdtot = pdtot_partner, self_coupling = self_coupling_partner, cross_coupling = cross_coupling_partner)
df_personaitydata_long <- bind_rows(df_personalitydata_patient, df_personalitydata_partner)

#merge personality data with SPAFF

df_personaitydata_long$UsrID <- paste0(df_personaitydata_long$PTNUM, df_personaitydata_long$Patient)
spaff_simp <- dplyr::select(df_personaitydata_long, DyadID, DyadID, iip_elevation, pdtot, Patient, UsrID, PTNUM) 
spaff_patpar_UsrIDs <- dplyr::select(spaff_patpar, UsrID) %>% unique()
spaff_patpar_UsrIDs <- as.vector(spaff_patpar_UsrIDs[["UsrID"]])
spaff_simp <- dplyr::filter(spaff_simp, UsrID %in% spaff_patpar_UsrIDs) 
spaff_simp_split <- split(spaff_simp, spaff_simp$UsrID)
spaff_patpar <- dplyr::filter(spaff_patpar, UsrID %in% as.vector(spaff_simp$UsrID))
spaff_patpar$n3 <- as.character(spaff_patpar$n3)
spaff_split <- split(spaff_patpar, spaff_patpar$UsrID)
# spaff_split <- lapply(spaff_split, function(x) {
#   x$n3 <- as.character(x$n3)
# })
for (i in 1:length(unique(spaff_patpar$UsrID))) {
  #num_nasty <- sum(as.character(x$n3) =="nasty")
  # num_nice <- sum(as.character(x$n3) == "nice")
  # num_neutral <- sum(as.character(x$n3) == "neutral")
  # time_nasty <- dplyr::filter(x, n3 == "nasty") %>% summarise(total_time= sum(diff_event)
  # time_neutral <- dplyr::filter(x,n3 == "neutral") %>% summarise(total_time = sum(diff_event)
  # time_nice <- dplyr::filter(x, n3 == "nice") %>% summarise(total_time = sum(diff_event)
  time_nasty = dplyr::filter(spaff_split[[i]],n3 =="nasty") %>% summarise(sum(diff_event))
  time_nice = dplyr::filter(spaff_split[[i]],n3 =="nice") %>% summarise(sum(diff_event))
  time_neutral = dplyr::filter(spaff_split[[i]],n3 == "neutral") %>% summarise(sum(diff_event))
  spaff_simp_split[[i]] <- dplyr::mutate(spaff_simp_split[[i]], 
                              num_nasty = sum(as.character(spaff_split[[i]]$n3) == "nasty"),
                              num_nice = sum(as.character(spaff_split[[i]]$n3) == "nice"),
                              num_neutral = sum(as.character(spaff_split[[i]]$n3) == "neutral"),
                              nastytime = time_nasty[[1]],
                              neutraltime = time_neutral[[1]],
                              nicetime = time_nice[[1]]
)
}
#cuts out 8093, because got cut from personality data

spaff_summarized <- ldply(spaff_simp_split, data.frame)
spaff_summarized_patient <- dplyr::filter(spaff_summarized, Patient == 1)
spaff_summarized_partner <- dplyr::filter(spaff_summarized, Patient == 0)
spaff_summarized_patient <- dplyr::rename(spaff_summarized_patient, pdtot_patient = pdtot, iip_elevation_patient = iip_elevation, num_nasty_patient = num_nasty, num_neutral_patient = num_neutral, num_nice_patient = num_nice, nastytime_patient = nastytime, neutraltime_patient = neutraltime, nicetime_patient = nicetime)
spaff_summarized_partner <- dplyr::rename(spaff_summarized_partner, pdtot_partner = pdtot, iip_elevation_partner = iip_elevation, num_nasty_partner = num_nasty, num_neutral_partner = num_neutral, num_nice_partner = num_nice, nastytime_partner = nastytime, neutraltime_partner = neutraltime, nicetime_partner= nicetime)
spaff_summarized_wide <- merge(spaff_summarized_patient, spaff_summarized_partner, by = c("PTNUM")) #117
spaff_summarized_wide<- mutate(spaff_summarized_wide, nastyproportion_patient = 1000*nastytime_patient/(nastytime_patient + neutraltime_patient + nicetime_patient),
                                     nastyproportion_partner = 1000*nastytime_partner/(nastytime_partner + nicetime_partner + neutraltime_partner))

```


##Load in pre-post data sets

```{r}
saamprepost_goodparams <- read.csv("m16dat7.csv")
saamprepost <- read.csv("dat7.csv")
imicprepost_goodparams <- read.csv("m22dat11.csv")
imicprepost <- read.csv("dat10.csv")
panasprepost_goodparams <- read.csv("m29dat14.csv")
panasprepost <- read.csv("dat13.csv")
```



#Build models to be tested with SPAFF
##SPAFF Mediation

```{r}
#a models are saturated. prune paths with sub models b...z
saam_avo_m1a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"
saam_anx_m1a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

imic_CON_m1a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

imic_AFF_m1a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

panas_na_m1a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

```


##Moderated SPAFF Mediation

```{r}
#Saturated Model
saam_avo_m2a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner


avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"
saam_anx_m2a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient +pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner


anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

imic_CON_m2a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

imic_AFF_m2a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

panas_na_m2a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"
```



##Moderated SPAFF + Coreg Mediation

```{r}
#Saturated Model
saam_avo_m3a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*avo_pre_patient
scpr ~ v_scpr + a7*avo_pre_partner 
ccpt ~ v_ccpt  + d8*avo_pre_patient
ccpr ~ v_ccpr + a8*avo_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner +c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr

"
saam_anx_m3a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr +b8*ccpr
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient +pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*anx_pre_patient
scpr ~ v_scpr + a7*anx_pre_partner 
ccpt ~ v_ccpt  + d8*anx_pre_patient
ccpr ~ v_ccpr + a8*anx_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_CON_m3a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*CON_pre_patient
scpr ~ v_scpr + a7*CON_pre_partner 
ccpt ~ v_ccpt  + d8*CON_pre_patient
ccpr ~ v_ccpr + a8*CON_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt  + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_AFF_m3a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
scpt ~ v_scpt + d7*AFF_pre_patient
scpr ~ v_scpr + a7*AFF_pre_partner 
ccpt ~ v_ccpt  + d8*AFF_pre_patient
ccpr ~ v_ccpr + a8*AFF_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

panas_na_m3a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*na_pre_patient
scpr ~ v_scpr + a7*na_pre_partner 
ccpt ~ v_ccpt  + d8*na_pre_patient
ccpr ~ v_ccpr + a8*na_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt

"
```


##Moderated SPAFF + Moderated Coreg Mediation
```{r}
#Saturated Model
saam_avo_m4a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*avo_pre_patient + iip_elevation_patient + pdtot_patient
scpr ~ v_scpr + a7*avo_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*avo_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*avo_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect  
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner +c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"
saam_anx_m4a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr +b8*ccpr
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient +pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*anx_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*anx_pre_partner + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*anx_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*anx_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_CON_m4a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*CON_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*CON_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*CON_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*CON_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt  + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_AFF_m4a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
scpt ~ v_scpt + d7*AFF_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*AFF_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*AFF_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*AFF_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

panas_na_m4a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*na_pre_patient + pdtot_patient + iip_elevation_patient  
scpr ~ v_scpr + a7*na_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*na_pre_patient+ pdtot_patient + iip_elevation_patient 
ccpr ~ v_ccpr + a8*na_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8

na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

```

#Merge personality data, pre-post measures, and SPAFF data sets

```{r}
##SAAM
#SPAFF
saamprepost_spaff_personalitydata <- inner_join(saamprepost, spaff_summarized_wide, by = "PTNUM")
saamprepost_spaff_personalitydata_rescaled<- mutate(saamprepost_spaff_personalitydata,
                                                      nastyratio_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
saamprepost_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(saamprepost_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)

saamprepost_spaff_personalitydata_rescaled_noOutliers <- saamprepost_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
                                                                                                                                 nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))

#SPAFF + vanbse
saamprepost_goodparams_spaff_personalitydata <- inner_join(saamprepost_goodparams, spaff_summarized_wide, by = "PTNUM")
saamprepost_goodparams_spaff_personalitydata_rescaled<- mutate(saamprepost_goodparams_spaff_personalitydata,
                                                      nastytime_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(saamprepost_goodparams_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)
saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = 50*(nastytime_patient/(nicetime_patient + neutraltime_patient)),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = 50*(neutraltime_patient/(nastytime_patient + nicetime_patient)),
                                                                                                                                 nastyratio_partner = 50*(nastytime_partner/(nicetime_partner + neutraltime_partner)),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = 50*(neutraltime_partner/(nastytime_partner + nicetime_partner)))

##IMI
#SPAFF
# imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
#                                                                                                                                  niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
#                                                                                                                                  neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
#                                                                                                                                  nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
#                                                                                                                                  niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
#                                                                                                                                  neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))

imicprepost_spaff_personalitydata <- inner_join(imicprepost, spaff_summarized_wide, by = "PTNUM")
imicprepost_spaff_personalitydata_rescaled<- mutate(imicprepost_spaff_personalitydata,
                                                      nastytime_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
imicprepost_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(imicprepost_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)

imicprepost_spaff_personalitydata_rescaled_noOutliers <- imicprepost_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
                                                                                                                                 nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))

#SPAFF + vanbse
imicprepost_goodparams_spaff_personalitydata <- inner_join(imicprepost_goodparams, spaff_summarized_wide, by = "PTNUM")
imicprepost_goodparams_spaff_personalitydata_rescaled<- mutate(imicprepost_goodparams_spaff_personalitydata,
                                                      nastytime_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(imicprepost_goodparams_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)

imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
                                                                                                                                 nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))


#PANAS
#SPAFF

panasprepost_spaff_personalitydata <- inner_join(panasprepost, spaff_summarized_wide, by = "PTNUM")
panasprepost_spaff_personalitydata_rescaled<- mutate(panasprepost_spaff_personalitydata,
                                                      nastytime_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
panasprepost_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(panasprepost_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)

panasprepost_spaff_personalitydata_rescaled_noOutliers <- panasprepost_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
                                                                                                                                 nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))

#SPAFF + vanbse
panasprepost_goodparams_spaff_personalitydata <- inner_join(panasprepost_goodparams, spaff_summarized_wide, by = "PTNUM")
panasprepost_goodparams_spaff_personalitydata_rescaled<- mutate(panasprepost_goodparams_spaff_personalitydata,
                                                      nastytime_patient = nastytime_patient/20,
                                                      nastytime_partner = nastytime_partner/20,
                                                      nicetime_patient = nicetime_patient/20,
                                                      nicetime_partner = nicetime_partner/20,
                                                      neutraltime_patient = neutraltime_patient/20,
                                                      neutraltime_partner = neutraltime_partner/20)
panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- dplyr::filter(panasprepost_goodparams_spaff_personalitydata_rescaled, neutraltime_patient > 0, nastytime_patient > 0, nicetime_patient >0, nastytime_partner > 0, nicetime_partner >0, neutraltime_partner >0)

panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = 50*(nastytime_patient/(nicetime_patient + neutraltime_patient)),
                                                                                                                                 niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
                                                                                                                                 neutralratio_patient = 50*(neutraltime_patient/(nastytime_patient + nicetime_patient)),
                                                                                                                                 nastyratio_partner = 50*(nastytime_partner/(nicetime_partner + neutraltime_partner)),
                                                                                                                                 niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
                                                                                                                                 neutralratio_partner = 50*(neutraltime_partner/(nastytime_partner + nicetime_partner)))
# 
# panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers <- panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers %>% mutate(nastyratio_patient = nastytime_patient/(nicetime_patient + neutraltime_patient),
#                                                                                                                                  niceratio_patient = 100*(nicetime_patient/(nastytime_patient + neutraltime_patient)),
#                                                                                                                                  neutralratio_patient = neutraltime_patient/(nastytime_patient + nicetime_patient),
#                                                                                                                                  nastyratio_partner = nastytime_partner/(nicetime_partner + neutraltime_partner),
#                                                                                                                                  niceratio_partner = 100*(nicetime_partner/(nastytime_partner + neutraltime_partner)),
#                                                                                                                                  neutralratio_partner = neutraltime_partner/(nastytime_partner + nicetime_partner))


```


#Run models
Note: Models 1 and 2 don't need coreg parameters so use the data set with out "goodparams"
First, run the models. 
```{r}
library(lavaan)
saam_avo_m1a_m <- sem(saam_avo_m1a, saamprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_avo_m2a_m <- sem(saam_avo_m2a, saamprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_avo_m3a_m <- sem(saam_avo_m3a, saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_avo_m4a_m <- sem(saam_avo_m4a, saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

saam_anx_m1a_m <- sem(saam_anx_m1a, saamprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_anx_m2a_m <- sem(saam_anx_m2a, saamprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_anx_m3a_m <- sem(saam_anx_m3a, saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
saam_anx_m4a_m <- sem(saam_anx_m4a, saamprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

imic_CON_m1a_m2 <- sem(imic_CON_m1a, imicprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
imic_CON_m2a_m <- sem(imic_CON_m2a, imicprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

imic_CON_m3a_m <- sem(imic_CON_m3a, imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
imic_CON_m4a_m <- sem(imic_CON_m4a, imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

imic_AFF_m1a_m <- sem(imic_AFF_m1a, imicprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
imic_AFF_m2a_m <- sem(imic_AFF_m2a, imicprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
imic_AFF_m3a_m <- sem(imic_AFF_m3a, imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
imic_AFF_m4a_m <- sem(imic_AFF_m4a, imicprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

panas_na_m1a_m <- sem(panas_na_m1a, panasprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
panas_na_m2a_m <- sem(panas_na_m2a, panasprepost_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
panas_na_m3a_m <- sem(panas_na_m3a, panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")
panas_na_m4a_m <- sem(panas_na_m4a, panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, missing = "ML", estimator = "MLR", meanstructure = TRUE, mimic = "Mplus")

  
```

Now, print summary statistics and examine fit measures. 

```{r}
summary(saam_avo_m1a_m, fit.measures = TRUE)
summary(saam_avo_m2a_m, fit.measures = TRUE)
summary(saam_avo_m3a_m, fit.measures = TRUE) 
summary(saam_avo_m4a_m, fit.measures = TRUE)

summary(saam_anx_m1a_m, fit.measures = TRUE)
summary(saam_anx_m2a_m, fit.measures = TRUE) 
summary(saam_anx_m3a_m, fit.measures = TRUE)
summary(saam_anx_m4a_m, fit.measures = TRUE)

summary(imic_CON_m1a_m, fit.measures = TRUE)
summary(imic_CON_m2a_m, fit.measures = TRUE)
summary(imic_CON_m3a_m, fit.measures = TRUE)
summary(imic_CON_m4a_m, fit.measures = TRUE)

summary(imic_AFF_m1a_m, fit.measures = TRUE)
summary(imic_AFF_m2a_m, fit.measures = TRUE)
summary(imic_AFF_m3a_m, fit.measures = TRUE)
summary(imic_AFF_m4a_m, fit.measures = TRUE)

summary(panas_na_m1a_m, fit.measures = TRUE)
summary(panas_na_m2a_m, fit.measures = TRUE)
summary(panas_na_m3a_m, fit.measures = TRUE)
summary(panas_na_m4a_m, fit.measures = TRUE)

```


#Diagnostics

```{r }
library(GGally) 
dplyr::select(panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers, scpt, ccpt, scpr, ccpr, na_pre_partner, na_post_partner, na_pre_patient, na_post_patient) %>% mutate_all(log) %>% ggpairs()
x<- panasprepost_goodparams_spaff_personalitydata_rescaled_noOutliers$na_pre_partner
factorx <- factor(cut(x, breaks=10))
#Tabulate and turn into data.frame
xout <- as.data.frame(table(factorx))
#Add cumFreq and proportions
xout <- transform(xout, cumFreq = cumsum(Freq), relative = prop.table(Freq))
xout


```

#Modification to Initial Models

```{r}
#a models are saturated. prune paths with sub models b...z
saam_avo_m1b <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~  b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ d1*avo_pre_patient
niceratio_patient~d2*avo_pre_patient
neutralratio_patient~d3*avo_pre_patient
nastyratio_partner~a4*avo_pre_partner 
niceratio_partner ~ a5*avo_pre_partner
neutralratio_partner ~ a6*avo_pre_partner
#indirect effect 
# a4b4:=a4*b4
# a5b5 := a5*b5
# a6b6 := a6*b6
# d1c1 := d1*d1
# d2c2 := d2*d2
# d3c3:=d3*d3
# d4c4:=d4*c4
# d5c5 := d5*c5
# d6c6 := d6*c6
# a1c1 := a1*c1
# a2c2 := a2*c2
# a3c3:=a3*c3
# a4c4:=a4*c4
# a5c5 := a5*c5
# a6c6 := a6*c6
# d1b1 := d1*b1
# d2b2 := d2*b2
# d3b3:=d3*b3
# d4b4:=d4*b4
# d5b5 := d5*b5
# d6b6 := d6*b6


avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient 
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"
saam_anx_m1b <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient 
nastyratio_patient ~ a1*anx_pre_partner 
niceratio_patient~a2*anx_pre_partner
neutralratio_patient~a3*anx_pre_partner
nastyratio_partner~  d4*anx_pre_patient
niceratio_partner ~d5*anx_pre_patient
neutralratio_partner ~d6*anx_pre_patient
# #indirect effect 
# a1b1 := a1*b1
# a2b2 := a2*b2
# a3b3:=a3*b3
# a4b4:=a4*b4
# a5b5 := a5*b5
# a6b6 := a6*b6
# d1c1 := d1*d1
# d2c2 := d2*d2
# d3c3:=d3*d3
# d4c4:=d4*c4
# d5c5 := d5*c5
# d6c6 := d6*c6
# a1c1 := a1*c1
# a2c2 := a2*c2
# a3c3:=a3*c3
# a4c4:=a4*c4
# a5c5 := a5*c5
# a6c6 := a6*c6
# d1b1 := d1*b1
# d2b2 := d2*b2
# d3b3:=d3*b3
# d4b4:=d4*b4
# d5b5 := d5*b5
# d6b6 := d6*b6


anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

imic_CON_m1b <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*CON_pre_partner 
niceratio_patient~a2*CON_pre_partner 
neutralratio_patient~a3*CON_pre_partner 
nastyratio_partner~ d4*CON_pre_patient
niceratio_partner ~d5*CON_pre_patient
neutralratio_partner ~d6*CON_pre_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6


CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

imic_AFF_m1b <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient 
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient
#indirect effect 
# a1b1 := a1*b1
# a2b2 := a2*b2
# a3b3:=a3*b3
# a4b4:=a4*b4
# a5b5 := a5*b5
# a6b6 := a6*b6
# d1c1 := d1*d1
# d2c2 := d2*d2
# d3c3:=d3*d3
# d4c4:=d4*c4
# d5c5 := d5*c5
# d6c6 := d6*c6
# a1c1 := a1*c1
# a2c2 := a2*c2
# a3c3:=a3*c3
# a4c4:=a4*c4
# a5c5 := a5*c5
# a6c6 := a6*c6
# d1b1 := d1*b1
# d2b2 := d2*b2
# d3b3:=d3*b3
# d4b4:=d4*b4
# d5b5 := d5*b5
# d6b6 := d6*b6


AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c2*niceratio_patient +c5*niceratio_partner 
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

panas_na_m1b <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient 
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient
#indirect effect 
# a1b1 := a1*b1
# a2b2 := a2*b2
# a3b3:=a3*b3
# a4b4:=a4*b4
# a5b5 := a5*b5
# a6b6 := a6*b6
# d1c1 := d1*d1
# d2c2 := d2*d2
# d3c3:=d3*d3
# d4c4:=d4*c4
# d5c5 := d5*c5
# d6c6 := d6*c6
# a1c1 := a1*c1
# a2c2 := a2*c2
# a3c3:=a3*c3
# a4c4:=a4*c4
# a5c5 := a5*c5
# a6c6 := a6*c6
# d1b1 := d1*b1
# d2b2 := d2*b2
# d3b3:=d3*b3
# d4b4:=d4*b4
# d5b5 := d5*b5
# d6b6 := d6*b6


na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient 
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

"

```


##Moderated SPAFF Mediation

```{r}
#Saturated Model
saam_avo_m2b <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner


avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient 

"
saam_anx_m2b <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~  b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*anx_pre_partner  + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner + pdtot_patient + iip_elevation_patient  + iip_elevation_partner
neutralratio_patient~a3*anx_pre_partner + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
# a1b1 := a1*b1
# a2b2 := a2*b2
# a3b3:=a3*b3
# a4b4:=a4*b4
# a5b5 := a5*b5
# a6b6 := a6*b6
# d1c1 := d1*d1
# d2c2 := d2*d2
# d3c3:=d3*d3
# d4c4:=d4*c4
# d5c5 := d5*c5
# d6c6 := d6*c6
# a1c1 := a1*c1
# a2c2 := a2*c2
# a3c3:=a3*c3
# a4c4:=a4*c4
# a5c5 := a5*c5
# a6c6 := a6*c6
# d1b1 := d1*b1
# d2b2 := d2*b2
# d3b3:=d3*b3
# d4b4:=d4*b4
# d5b5 := d5*b5
# d6b6 := d6*b6
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner


anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

imic_CON_m2b <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

imic_AFF_m2a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"

panas_na_m2a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6

nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner

na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner

"
```



##Moderated SPAFF + Coreg Mediation

```{r}
#Saturated Model
saam_avo_m3a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*avo_pre_patient
scpr ~ v_scpr + a7*avo_pre_partner 
ccpt ~ v_ccpt  + d8*avo_pre_patient
ccpr ~ v_ccpr + a8*avo_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner +c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr

"
saam_anx_m3a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr +b8*ccpr
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient +pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*anx_pre_patient
scpr ~ v_scpr + a7*anx_pre_partner 
ccpt ~ v_ccpt  + d8*anx_pre_patient
ccpr ~ v_ccpr + a8*anx_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_CON_m3a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*CON_pre_patient
scpr ~ v_scpr + a7*CON_pre_partner 
ccpt ~ v_ccpt  + d8*CON_pre_patient
ccpr ~ v_ccpr + a8*CON_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt  + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_AFF_m3a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
scpt ~ v_scpt + d7*AFF_pre_patient
scpr ~ v_scpr + a7*AFF_pre_partner 
ccpt ~ v_ccpt  + d8*AFF_pre_patient
ccpr ~ v_ccpr + a8*AFF_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

panas_na_m3a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*na_pre_patient
scpr ~ v_scpr + a7*na_pre_partner 
ccpt ~ v_ccpt  + d8*na_pre_patient
ccpr ~ v_ccpr + a8*na_pre_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt

"
```


##Moderated SPAFF + Moderated Coreg Mediation
```{r}
#Saturated Model
saam_avo_m4a <- "
#direct effect
avo_post_partner ~ e*avo_pre_partner
#mediators
avo_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*avo_pre_partner + d1*avo_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*avo_pre_partner +  d2*avo_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*avo_pre_partner + d3*avo_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*avo_pre_partner +  d4*avo_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*avo_pre_partner +  d5*avo_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*avo_pre_partner + d6*avo_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*avo_pre_patient + iip_elevation_patient + pdtot_patient
scpr ~ v_scpr + a7*avo_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*avo_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*avo_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect  
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8
avo_post_patient ~ f*avo_pre_patient 
avo_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner +c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"
saam_anx_m4a <-  "
#direct effect
anx_post_partner ~ e*anx_pre_partner
#mediators
anx_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr +b8*ccpr
nastyratio_patient ~ a1*anx_pre_partner + d1*anx_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*anx_pre_partner +  d2*anx_pre_patient + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*anx_pre_partner + d3*anx_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*anx_pre_partner +  d4*anx_pre_patient +pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*anx_pre_partner +  d5*anx_pre_patient + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*anx_pre_partner + d6*anx_pre_patient + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*anx_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*anx_pre_partner + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*anx_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*anx_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
anx_post_patient ~ f*anx_pre_patient 
anx_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_CON_m4a <-  "
#direct effect
CON_post_partner ~ e*CON_pre_partner
#mediators
CON_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*CON_pre_partner + d1*CON_pre_patient + pdtot_patient + iip_elevation_patient
niceratio_patient~a2*CON_pre_partner +  d2*CON_pre_patient  + pdtot_patient + iip_elevation_patient
neutralratio_patient~a3*CON_pre_partner + d3*CON_pre_patient + pdtot_patient + iip_elevation_patient
nastyratio_partner~a4*CON_pre_partner +  d4*CON_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*CON_pre_partner +  d5*CON_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*CON_pre_partner + d6*CON_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*CON_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*CON_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*CON_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*CON_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
CON_post_patient ~ f*CON_pre_patient 
CON_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt  + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

imic_AFF_m4a <-  "
#direct effect
AFF_post_partner ~ e*AFF_pre_partner
#mediators
AFF_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*AFF_pre_partner + d1*AFF_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*AFF_pre_partner +  d2*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*AFF_pre_partner + d3*AFF_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*AFF_pre_partner +  d4*AFF_pre_patient + pdtot_partner + iip_elevation_patient
niceratio_partner ~ a5*AFF_pre_partner +  d5*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
neutralratio_partner ~ a6*AFF_pre_partner + d6*AFF_pre_patient  + pdtot_partner + iip_elevation_patient
scpt ~ v_scpt + d7*AFF_pre_patient + pdtot_patient + iip_elevation_patient
scpr ~ v_scpr + a7*AFF_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*AFF_pre_patient + pdtot_patient + iip_elevation_patient
ccpr ~ v_ccpr + a8*AFF_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
c7d7:=c7*d7
c8d8:=c8*d8
a7b7:=a7*b7
a8b8:=a8*b8
AFF_post_patient ~ f*AFF_pre_patient 
AFF_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

panas_na_m4a <-  "
#direct effect
na_post_partner ~ e*na_pre_partner
#mediators
na_post_partner ~ b1*nastyratio_patient + b2*niceratio_patient + b3*neutralratio_patient + b4*nastyratio_partner + b5*niceratio_partner + b6*neutralratio_partner + b7*scpr + b8*ccpr
nastyratio_patient ~ a1*na_pre_partner + d1*na_pre_patient + pdtot_patient + iip_elevation_patient 
niceratio_patient~a2*na_pre_partner +  d2*na_pre_patient  + pdtot_patient + iip_elevation_patient 
neutralratio_patient~a3*na_pre_partner + d3*na_pre_patient  + pdtot_patient + iip_elevation_patient 
nastyratio_partner~a4*na_pre_partner +  d4*na_pre_patient + pdtot_partner + iip_elevation_partner
niceratio_partner ~ a5*na_pre_partner +  d5*na_pre_patient  + pdtot_partner + iip_elevation_partner
neutralratio_partner ~ a6*na_pre_partner + d6*na_pre_patient  + pdtot_partner + iip_elevation_partner
scpt ~ v_scpt + d7*na_pre_patient + pdtot_patient + iip_elevation_patient  
scpr ~ v_scpr + a7*na_pre_partner  + pdtot_partner + iip_elevation_partner
ccpt ~ v_ccpt  + d8*na_pre_patient+ pdtot_patient + iip_elevation_patient 
ccpr ~ v_ccpr + a8*na_pre_partner + pdtot_partner + iip_elevation_partner
#indirect effect 
a1b1 := a1*b1
a2b2 := a2*b2
a3b3:=a3*b3
a4b4:=a4*b4
a5b5 := a5*b5
a6b6 := a6*b6
d1c1 := d1*d1
d2c2 := d2*d2
d3c3:=d3*d3
d4c4:=d4*c4
d5c5 := d5*c5
d6c6 := d6*c6
a1c1 := a1*c1
a2c2 := a2*c2
a3c3:=a3*c3
a4c4:=a4*c4
a5c5 := a5*c5
a6c6 := a6*c6
d1b1 := d1*b1
d2b2 := d2*b2
d3b3:=d3*b3
d4b4:=d4*b4
d5b5 := d5*b5
d6b6 := d6*b6
a7b7:=a7*b7
a8b8:=a8*b8
c7d7:=c7*d7
c8d8:=c8*d8

na_post_patient ~ f*na_pre_patient 
na_post_patient ~ c1*nastyratio_patient + c2*niceratio_patient + c3*neutralratio_patient + c4*nastyratio_partner + c5*niceratio_partner + c6*neutralratio_partner + c7*scpt + c8*ccpt
nastyratio_patient ~~ nastyratio_partner
nastyratio_patient ~~ niceratio_partner
nastyratio_patient ~~ neutralratio_partner
nastyratio_patient ~~ niceratio_patient
nastyratio_patient ~~ neutralratio_patient
niceratio_patient ~~nastyratio_partner
niceratio_patient ~~ niceratio_partner
niceratio_patient ~~ neutralratio_partner
niceratio_patient ~~ neutralratio_patient
neutralratio_patient ~~ nastyratio_partner
neutralratio_patient ~~ niceratio_partner
neutralratio_patient ~~ neutralratio_partner
nastyratio_partner ~~ neutralratio_partner
nastyratio_partner ~~ niceratio_partner
neutralratio_partner ~~ niceratio_partner
scpt ~~ scpr
scpt ~~ccpt
scpt ~~ccpr
ccpt~~scpr
ccpt ~~ccpr
scpr ~~ ccpr
"

```

